{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["// функції для HTTP-запитів.\n\nimport axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\n//----замінити ключ на свій, коли вийде зареєструватися-------------\nconst API_KEY = '43173775-fc7269b10cca3a5d436001063';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function showImages(userRequest, page = 1) {\n  try {\n    const response = await axios.get(BASE_URL, {\n      params: {\n        key: API_KEY,\n        q: userRequest,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        per_page: 15,\n        page: page,\n      },\n    });\n\n    if (response.status !== 200) {\n      throw new Error('Request failed with status: ' + response.status); // Перевірка статусу відповіді сервера\n    }\n\n    if (response.data.hits.length === 0) {\n      //перевірка наявності зображень у відповіді\n      throw new Error(\n        'Sorry, there are no images matching <br>your search query.Please try again!'\n      ); // Генерується помилка, якщо список зображень порожній\n    }\n    return { images: response.data.hits, totalHits: response.data.totalHits };\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    iziToast.error({\n      message: error.message,\n      backgroundColor: '#EF4040',\n      messageColor: '#FAFAFB',\n      position: 'topRight',\n    });\n    throw error;\n  }\n}\n","// функції для відображення елементів інтерфейсу.\n\nexport function createMarkup(arr) {\n  return arr\n    .map(\n      ({\n        likes,\n        views,\n        comments,\n        downloads,\n        webformatURL,\n        largeImageURL,\n        tags,\n        id,\n      }) => `<li data-id=\"${id}\">\n      <div class=\"gallery\">\n        <a class='large-image' href=\"${largeImageURL}\">\n          <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"preview-image\" width=\"360\" height=\"152\">\n        </a>\n      </div>\n      <div class=\"info-container\">\n        <div class=\"info-box\">\n          <span class=\"label\">Likes</span>\n          <span class=\"data-label\">${likes}</span>\n        </div>\n        <div class=\"info-box\">\n          <span class=\"label\">Views</span>\n          <span class=\"data-label\">${views}</span>\n        </div>\n        <div class=\"info-box\">\n          <span class=\"label\">Comments</span>\n          <span class=\"data-label\">${comments}</span>\n        </div>\n        <div class=\"info-box\">\n          <span class=\"label\">Downloads</span>\n          <span class=\"data-label\">${downloads}</span>\n        </div>\n      </div>\n  </li>`\n    )\n    .join('');\n}\n","// Імпорт SimpleLightbox та інших залежностей\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { showImages } from './js/pixabay-api.js';\nimport { createMarkup } from './js/render-functions.js';\n\n// Пошук елементів DOM\nconst searchForm = document.querySelector('form');\nconst searchInput = document.querySelector('input');\nconst list = document.querySelector('ul');\nconst loaders = document.getElementById('spinner');\nconst loadMoreButton = document.getElementById('load-more');\nconst loadMoreSpinner = document.getElementById('spinner-load-more');\n\n// Додавання обробників подій\nsearchForm.addEventListener('submit', handleSubmit);\nloadMoreButton.addEventListener('click', handleLoadMore);\n\nlet userRequest = ''; // Змінна для запиту користувача\nlet lightbox; // Змінна для SimpleLightbox\nlet page = 1; // Поточна сторінка\nlet totalHits = 0; // Загальна кількість результатів пошуку\n\n// Функція обробки події submit\nasync function handleSubmit(event) {\n  event.preventDefault();\n  list.innerHTML = ''; // Очищення списку перед новим пошуком\n  page = 1; // Скидання сторінки до 1\n  loadMoreButton.style.display = 'none'; // Ховає кнопку \"Load more\"\n\n  userRequest = searchInput.value.trim().toLowerCase(); // Оновлення userRequest\n\n  if (!userRequest || userRequest.trim() === '') {\n    iziToast.error({\n      message: 'Sorry, the query field is empty.',\n      backgroundColor: '#EF4040',\n      messageColor: '#FAFAFB',\n      position: 'topRight',\n    });\n    searchInput.value = ''; // Очищення поля вводу\n    userRequest = ''; // Обнулення змінної userRequest\n    return;\n  }\n\n  loaders.style.display = 'block'; // Показує спінер\n\n  try {\n    const { images, totalHits: hits } = await showImages(userRequest, page);\n    totalHits = hits; // Оновлення загальної кількості результатів пошуку\n    list.innerHTML = ''; // Очищення списку перед новим пошуком\n    list.insertAdjacentHTML('beforeend', createMarkup(images));\n\n    if (images.length < 15 || list.children.length >= totalHits) {\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        backgroundColor: '#5A5A5A',\n        messageColor: '#FAFAFB',\n        position: 'topRight',\n      });\n      loadMoreButton.style.display = 'none'; // Ховає кнопку \"Load more\", якщо досягнуто кінець колекції\n    } else {\n      loadMoreButton.style.display = 'block'; // Показує кнопку \"Load more\", якщо ще є зображення для завантаження\n    }\n\n    // Ініціалізація SimpleLightbox\n    if (!lightbox) {\n      lightbox = new SimpleLightbox('.gallery a', {\n        nav: true,\n        captions: true,\n        captionsData: 'alt',\n        captionDelay: 250,\n      });\n    } else {\n      lightbox.refresh(); // Оновлення SimpleLightbox\n    }\n  } catch (error) {\n    console.error('Error fetching images:', error);\n  } finally {\n    loaders.style.display = 'none'; // Приховує спінер\n    searchInput.value = ''; // Очищення поля вводу\n  }\n}\n\n// Функція обробки події натискання на кнопку \"Load more\"\nasync function handleLoadMore() {\n  page += 1;\n  loadMoreSpinner.style.display = 'block'; // Показує нижній спінер\n  try {\n    const { images } = await showImages(userRequest, page);\n    list.insertAdjacentHTML('beforeend', createMarkup(images));\n    lightbox.refresh();\n\n    // Отримання висоти однієї карти\n    const { height: cardHeight } =\n      list.firstElementChild.getBoundingClientRect();\n    // Прокрутка сторінки на дві висоти картки\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n\n    if (images.length < 15 || list.children.length >= totalHits) {\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        backgroundColor: '#5A5A5A',\n        messageColor: '#FAFAFB',\n        position: 'topRight',\n      });\n\n      loadMoreButton.style.display = 'none'; // Ховає кнопку \"Load more\", якщо досягнуто кінець колекції\n    }\n  } catch (error) {\n    console.error('Error fetching images:', error);\n  } finally {\n    loadMoreSpinner.style.display = 'none'; // Приховує нижній спінер\n  }\n}\n"],"names":["API_KEY","BASE_URL","showImages","userRequest","page","response","axios","error","iziToast","createMarkup","arr","likes","views","comments","downloads","webformatURL","largeImageURL","tags","id","searchForm","searchInput","list","loaders","loadMoreButton","loadMoreSpinner","handleSubmit","handleLoadMore","lightbox","totalHits","event","images","hits","SimpleLightbox","cardHeight"],"mappings":"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"}